<include file="public@header"/>
<style>
	.bg-gray {
	    color: #000;
	    background-color: #d2d6de !important;
	}
	.bg-red, .callout.callout-danger, .alert-danger, .alert-error, .modal-danger .modal-body {
	    background-color: #e74c3c !important;
	}
</style>
</head>
<body>
<div class="wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a>{:lang('USER_INDEXADMIN_INDEX')}</a></li>
    </ul>
    <form class="well form-inline margin-top-20" method="post" action="{:url('user/adminIndex/index')}">
        用户ID：
        <input class="form-control" type="text" name="uid" style="width: 200px;" value="{:input('request.uid')}"
               placeholder="请输入用户ID">
        关键字：
        <input class="form-control" type="text" name="keyword" style="width: 200px;" value="{:input('request.keyword')}"
               placeholder="用户名/昵称/邮箱">
		设备来源：
        <select class="form-control" name="source">
            <option value="">全部</option>
                <option value="0" <if condition="input('request.source') neq '' && input('request.source') eq '0'">selected</if>>PC</option>
                <option value="1" <if condition="input('request.source') neq '' && input('request.source') eq '1'">selected</if>>安卓APP</option>
                <option value="2" <if condition="input('request.source') neq '' && input('request.source') eq '2'">selected</if>>苹果APP</option>
                <option value="3" <if condition="input('request.source') neq '' && input('request.source') eq '3'">selected</if>>小程序</option>
        </select>

        提交时间：
        <input class="form-control js-bootstrap-date" name="start_time" id="start_time" value="{:input('request.start_time')}" aria-invalid="false" style="width: 110px;"> - 
        <input class="form-control js-bootstrap-date" name="end_time" id="end_time" value="{:input('request.end_time')}" aria-invalid="false" style="width: 110px;">
            	   
        <input type="submit" class="btn btn-primary" value="搜索"/>
        <a class="btn btn-danger" href="{:url('user/adminIndex/index')}">清空</a>
		<br>
        <br>
		<a href="javascript:;" class="btn btn-default" style="font-size:14px;color:#ea5858;">
			<i class="fa fa-user fa-fw"></i>
			<span class="extend">
				用户总人数：<span id="personnum">{$nums}</span>
			</span>
		</a>
		<a href="javascript:;" class="btn btn-default" style="font-size:14px;color:dodgerblue;">
			<i class="fa fa-user fa-fw"></i>
			<span class="extend">
				在线总人数：<span id="personnum">{$online}</span>
			</span>
		</a>
    </form>
    <form method="post" class="js-ajax-form">
		<div style="overflow:scroll;">
        <table style="width: 225rem;" class="table table-hover table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>{:lang('USERNAME')}</th>
                <th>{:lang('NICENAME')}</th>
                <th>{:lang('AVATAR')}</th>
                <!--<th>{:lang('EMAIL')}</th>-->
				<!--新增栏目开始-->
				<th>在线状态</th>
				<th>性别</th>
				<th>系统</th>
				<th>实名</th>
				<th>真实姓名</th>
				<th>身份证</th>
				<th>登录渠道</th>
				<!--新增栏目结束-->
                <th>余额</th>
                <th>累计消费</th>
				<th>订单消费总额</th>
				<th>礼物消费总额</th>
                <!--<th>订单收益余额</th>
                <th>订单收益总额</th>
                <th>礼物收益余额</th>
                <th>礼物收益总额</th>-->
                <th>{:lang('REGISTRATION_TIME')}</th>
                <th>{:lang('LAST_LOGIN_TIME')}</th>
                <th>{:lang('LAST_LOGIN_IP')}</th>
                <th>{:lang('STATUS')}</th>
                <th>{:lang('ACTIONS')}</th>
            </tr>
            </thead>
            <tbody>
            <php>
                $user_statuses=array("0"=>lang('USER_STATUS_BLOCKED'),"1"=>lang('USER_STATUS_ACTIVATED'),"2"=>lang('USER_STATUS_UNVERIFIED'));
            </php>
            <foreach name="list" item="vo">
                <tr>
                    <td>{$vo.id}</td>
                    <td>{$vo['user_login']?$vo['user_login']:($vo['mobile']?$vo['mobile']:lang('THIRD_PARTY_USER'))}
                    </td>
                    <td>{$vo['user_nickname']?$vo['user_nickname']:lang('NOT_FILLED')}</td>
                    <td><img width="25" height="25" src="{:get_upload_path($vo['avatar'])}"/></td>
                    <!--<td>{$vo.user_email}</td>-->
					<!--新增栏目开始-->
					<td>{$vo.online?'<span class="label bg-red">在线</span>':'<span class="label bg-gray">离线</span>'}</td>
					<td>
						<if condition="$vo.sex==0">
							保密
						<elseif condition="$vo.sex==1">
							<span style="color:#cc2020;">男</span>
						<elseif condition="$vo.sex==2">
							<span style="color:green">女</span>
						</if>
					</td>
					<td>
						<if condition="$vo.source==0">
							web
						<elseif condition="$vo.source==1">
							android
						<elseif condition="$vo.source==2">
							ios
						<elseif condition="$vo.source==3">
							小程序
						</if>
					</td>
					<td>
						<if condition="$vo.isauth==0">
							未认证
						<else>
							<span style="color:#cc2020">
							已认证
							</span>
						</if>
					</td>
					<td>{$vo.name==''?'-':$vo.name}</td>
					<td>{$vo.cer_no==''?'-':$vo.cer_no}</td>
					<td>
						<if condition="$vo.login_type==0">
							PC
						<elseif condition="$vo.login_type==1">
							QQ
						<elseif condition="$vo.login_type==2">
							微信
						<elseif condition="$vo.login_type==3">
							新浪
						<elseif condition="$vo.login_type==4">
							facebook
						<elseif condition="$vo.login_type==5">
							twitter
						<elseif condition="$vo.login_type==6">
							ios
						</if>
					</td>
					<!--新增栏目结束-->
                    <td>{$vo.coin}</td>
                    <td>{$vo.consumption}</td>
					<td>{$vo.total3}</td>
					<td>{$vo.total2}</td>
                    <!--<td>{$vo.votes}</td>
                    <td>{$vo.votestotal}</td>
					<td>{$vo.votes_gift}</td>
                    <td>{$vo.votes_gifttotal}</td>-->
                    <td>{:date('Y-m-d H:i:s',$vo['create_time'])}</td>
                    <td>{:date('Y-m-d H:i:s',$vo['last_login_time'])}</td>
                    <td>{$vo.last_login_ip}</td>
                    <td>
                        <switch name="vo.user_status">
                            <case value="0">
                                <span class="label label-danger">{$user_statuses[$vo['user_status']]}</span>
                            </case>
                            <case value="1">
                                <span class="label label-success">{$user_statuses[$vo['user_status']]}</span>
                            </case>
                            <case value="2">
                                <span class="label label-warning">{$user_statuses[$vo['user_status']]}</span>
                            </case>
                        </switch>
                    </td>
                    <td>
						<a class="btn btn-xs btn-primary" style="background-color: #18bc9c;border-color: #18bc9c;" href="javascript:parent.openIframeLayer('{:url('adminIndex/update',array('user_id'=>$vo['id']))}','管理 {$vo.name} 页面',{});">编辑</a>
                        <neq name="vo.id" value="1">
                            <empty name="vo.user_status">
                                <a class="btn btn-xs btn-success js-ajax-dialog-btn"
                                   href="{:url('adminIndex/cancelban',array('id'=>$vo['id']))}"
                                   data-msg="{:lang('ACTIVATE_USER_CONFIRM_MESSAGE')}">{:lang('ACTIVATE_USER')}</a>
                                <else/>
                                <a class="btn btn-xs btn-warning js-ajax-dialog-btn"
                                   href="{:url('adminIndex/ban',array('id'=>$vo['id']))}"
                                   data-msg="{:lang('BLOCK_USER_CONFIRM_MESSAGE')}">{:lang('BLOCK_USER')}</a>
                            </empty>
                            <else/>
                            <a class="btn btn-xs btn-warning disabled">{:lang('BLOCK_USER')}</a>
                        </neq>
                         <!--<if condition="$vo.isrecommend eq '1'">
							<a class="btn btn-xs btn-info js-ajax-dialog-btn"
								   href="{:url('adminIndex/setrecommend',array('id'=>$vo['id'],'isrecommend'=>0))}">取消推荐</a>
						<else/>
							<a class="btn btn-xs btn-info js-ajax-dialog-btn"
								   href="{:url('adminIndex/setrecommend',array('id'=>$vo['id'],'isrecommend'=>1))}">推荐</a>
						</if>-->
                        <if condition="$vo['ishost'] eq 1">
                            <a class="btn btn-xs btn-primary js-ajax-dialog-btn" href="{:url('adminIndex/setHost',array('id'=>$vo['id'],'ishost'=>0))}" >取消派单主持人</a>
                        <else/>
                            <a class="btn btn-xs btn-primary js-ajax-dialog-btn" href="{:url('adminIndex/setHost',array('id'=>$vo['id'],'ishost'=>1))}">设为派单主持人</a>
                        </if>
                        
                        <a class="btn btn-xs btn-danger js-ajax-dialog-btn"
                                   href="{:url('adminIndex/del',array('id'=>$vo['id']))}"
                                   data-msg="您确定要删除此用户么？">{:lang('DELETE')}</a>
                    </td>
                </tr>
            </foreach>
            </tbody>
        </table>
		</div>
        <div class="pagination">{$page}</div>
    </form>
</div>
<script src="__STATIC__/js/admin.js"></script>
</body>
</html>